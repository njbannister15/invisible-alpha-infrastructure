    "LaunchConfig": {
      "Type": "AWS::AutoScaling::LaunchConfiguration",
      "Properties": {
        "ImageId": "ami-d15a75c7",
        "AssociatePublicIpAddress": "true",
        "InstanceType": {
          "Ref": "ServerInstanceType"
        },
        "KeyName": {
          "Ref": "LoginKeyName"
        },
        "SpotPrice": "0.20",
        "SecurityGroups": [
          {
            "Ref": "MasterServerSecurityGroup"
          }
        ],
        "UserData": {
          "Fn::Base64": {
            "Fn::Join": [
              "",
              [
                "#!/bin/bash -v\n",
                "set -e -x\n",
                "export DEBIAN_FRONTEND=noninteractive\n",
                "apt-get -y update && apt-get -y upgrade\n",
                "apt-get -y install apt-transport-https ca-certificates curl software-properties-common\n",
                "curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -\n",
                "add-apt-repository \"deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable\"\n",
                "apt-get -y update\n",
                "apt-get -y install docker-ce\n",
                "curl -L https://github.com/docker/compose/releases/download/1.14.0/docker-compose-`uname -s`-`uname -m` > /usr/local/bin/docker-compose\n",
                "chmod +x /usr/local/bin/docker-compose\n",
                "usermod -aG docker ubuntu\n",
                "curl -sL https://deb.nodesource.com/setup_6.x | sudo -E bash -\n",
                "apt-get install -y nodejs\n",
                "apt-get install -y build-essential\n",
                "apt-get install -y openjdk-8-jre-headless\n",
                "# wget http://mirrors.jenkins.io/war-stable/latest/jenkins.war\n",
                "wget -q -O - https://pkg.jenkins.io/debian/jenkins.io.key | sudo apt-key add -\n",
                "sh -c 'echo deb http://pkg.jenkins.io/debian-stable binary/ > /etc/apt/sources.list.d/jenkins.list'\n",
                "apt-get update -y\n",
                "apt-get install -y jenkins\n",
                "usermod -aG docker jenkins\n"
              ]
            ]
          }
        }
      }
    },
    "AutoScalingGroup": {
      "Type": "AWS::AutoScaling::AutoScalingGroup",
      "Properties": {
        "DesiredCapacity": "1",
        "LaunchConfigurationName": {
          "Ref": "LaunchConfig"
        },
        "MaxSize": "1",
        "MinSize": "1",
        "Tags": [
          {
            "Key": "Name",
            "Value": {
              "Fn::Sub": "${Environment}.Instance.JenkinsMaster"
            },
            "PropagateAtLaunch": "true"
          }
        ],
        "VPCZoneIdentifier": [
          {
            "Fn::Select": [
              "0",
              {
                "Fn::Split": [
                  "|",
                  {
                    "Fn::ImportValue": {
                      "Fn::Sub": "${Environment}:Subnets:Public"
                    }
                  }
                ]
              }
            ]
          }
        ]
      }
    },





    ,
      "CreationPolicy": {
        "ResourceSignal": {
          "Count" : "1",
          "Timeout": "PT5M"
        }
      }